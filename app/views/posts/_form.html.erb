<%= form_for(@post) do |f| %>
  <% if @post.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% @post.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>





 
 <div class="form-group">
    
    <%= f.text_area :summary, class: "form-control", maxlength: "300",placeholder:"share the story in maximum 300 characters", style:"width:80%;height:80%;border: none",:autofocus => true %>
  </div>



<script language="javascript" type="text/javascript"> 

var LabelCounter = 0;

function parseCharCounts()
{
  //Get Everything...
  var elements = document.getElementsByTagName('textarea');
  var element = null;
  var maxlength = 9;
  var newlabel = null;
  
  for(var i=0; i < elements.length; i++)
  {
    element = elements[i];
    
    if(element.getAttribute('maxlength') != null && element.getAttribute('limiterid') == null)
    {
      maxlength = element.getAttribute('maxlength');
      
      //Create new label
      newlabel = document.createElement('label');
      newlabel.id = 'limitlbl_' + LabelCounter;
      newlabel.style.color = 'red';
      newlabel.style.display = 'block'; //Make it block so it sits nicely.
      newlabel.innerHTML = "Updating...";
      
      //Attach limiter to our textarea
      element.setAttribute('limiterid', newlabel.id);
      element.onkeyup = function(){ displayCharCounts(this); };
      
      //Append element
      element.parentNode.insertBefore(newlabel, element);
      
      //Force the update now!
      displayCharCounts(element);
    }
    
    //Push up the number
    LabelCounter++;
  }
}

function displayCharCounts(element)
{
  var limitLabel = document.getElementById(element.getAttribute('limiterid'));
  var maxlength = element.getAttribute('maxlength');
  var enforceLength = false;
  if(element.getAttribute('lengthcut') != null && element.getAttribute('lengthcut').toLowerCase() == 'true')
  {
    enforceLength = true;
  }
  
  //Replace \r\n with \n then replace \n with \r\n
  //Can't replace \n with \r\n directly because \r\n will be come \r\r\n

  //We do this because different browsers and servers handle new lines differently.
  //Internet Explorer and Opera say a new line is \r\n
  //Firefox and Safari say a new line is just a \n
  //ASP.NET seems to convert any plain \n characters to \r\n, which leads to counting issues
  var value = element.value.replace(/\u000d\u000a/g,'\u000a').replace(/\u000a/g,'\u000d\u000a');
  var currentLength = value.length;
  var remaining = 0;
  
  if(maxlength == null || limitLabel == null)
  {
    return false;
  }
  remaining = maxlength - currentLength;
  
  if(remaining >= 0)
  {
    limitLabel.style.color = '#7f8c8d';
    limitLabel.innerHTML = remaining + ' ';
    if(remaining != 1)
      limitLabel.innerHTML += '';
    limitLabel.innerHTML += ' ';
  }
  else
  {
    if (enforceLength == true) {
      value = value.substring(0, maxlength);
      element.value = value;
      element.setSelectionRange(maxlength, maxlength);
      limitLabel.style.color = 'green';
      limitLabel.innerHTML = '0 characters remaining';
    }
    else {
      //Non-negative
      remaining = Math.abs(remaining);
      
      limitLabel.style.color = 'red';
      limitLabel.innerHTML = 'Over by ' + remaining + ' character';
      if (remaining != 1) 
        limitLabel.innerHTML += 's';
      limitLabel.innerHTML += '!';
    }
  }
}

//Go find our textareas with maxlengths and handle them when we load!
parseCharCounts();
</script>














<div class="form-group">
    <% f.label :title %>
    <% f.text_field :title, class: "form-control",:autofocus => true%>
  </div>
  
  <div class="form-group">
    <% f.label :point_2 %>
    <% f.text_area :summary2,class: "form-control", maxlength: "90",:autofocus => true %>
  </div>

  <div class="form-group">
    <% f.label :point_3 %>
    <% f.text_area :summary3,class: "form-control", maxlength: "90", :autofocus => true %>
  </div>

  <div class="form-group">
    <% f.label :url %>
    <% f.text_field :source,class: "form-control", :autofocus => true %>
  </div>
  
  
<div class="actions">
    <%= f.submit %>
  </div>

 <% end %>
